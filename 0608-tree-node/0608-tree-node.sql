SELECT DISTINCT A.ID, CASE
    WHEN A.P_ID IS NULL THEN 'Root'
    WHEN B.ID IS NULL THEN 'Leaf'
    ELSE 'Inner' END AS TYPE
FROM TREE A LEFT JOIN TREE B
ON A.ID = B.P_ID